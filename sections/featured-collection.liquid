<section class="featured-collections">
  {%- comment -%}
    Featured Collections Section
    Displays up to three selected collections in a grid layout.
  {%- endcomment -%}

  {%- comment -%}
    Display the heading if it is set in the section settings.
    Use the 'escape' filter to prevent XSS attacks.
  {%- endcomment -%}
  {%- if section.settings.heading != blank -%}
    <h2 class="featured-collections__heading">{{ section.settings.heading | escape }}</h2>
  {%- endif -%}

  <p>Selected count: {{ section.settings.collections | size }}</p>

  <div class="featured-collections__grid">
    {%- comment -%}
      Loop through the selected collections (up to 3) and display each one.
      If no collections are selected, show a message prompting the user to select some.
    {%- endcomment -%}
    {%- assign picked = section.settings.collections -%}
    {%- if picked and picked.size > 0 -%}
      {%- for collection in picked limit: 3 -%}
        {%- if collection -%}
          <article class="collection-card">
            <a class="collection-card__link" href="{{ collection.url }}">
              <div class="collection-card__image-wrap">
                {%- if collection.image -%}
                  <img src="{{ collection.image | image_url: width: 800 }}" alt="{{ collection.title | escape }}" width="800" height="600" loading="lazy">
                {%- elsif collection.products_count > 0 and collection.products.first.featured_image -%}
                  <img src="{{ collection.products.first.featured_image | image_url: width: 800 }}" alt="{{ collection.title | escape }}" width="800" height="600" loading="lazy">
                {%- else -%}
                  <div class="collection-card__placeholder"></div>
                {%- endif -%}
              </div>
              <h3 class="collection-card__title">{{ collection.title }}</h3>
            </a>
          </article>
        {%- endif -%}
      {%- endfor -%}
    {%- else -%}
      <p class="featured-collections__empty">Select up to three collections in the section settings.</p>
    {%- endif -%}
  </div>
</section>

{%- comment -%}
  Schema for the Featured Collections section
  Allows selection of up to three collections and a custom heading in the theme editor
{%- endcomment -%}
{% schema %}
{
  "name": "Featured collections (3)",
  "settings": [
    { "type": "text", "id": "heading", "label": "Heading", "default": "Featured collections" },
    { "type": "collection_list", "id": "collections", "label": "Collections", "limit": 3 }
  ],
  "presets": [{ "name": "Featured collections (3)" }]
}
{% endschema %}
