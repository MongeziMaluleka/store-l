{%- comment -%}
  Section: All products (by handle)
  Purpose: Render products from a chosen collection handle; default is all-products.
{%- endcomment -%}

{%- assign handle = section.settings.collection_handle | default: 'all-products' -%}
{%- assign coll = collections[handle] -%}

<section class="ap ap--{{ section.id }}">
  <h2 style="background-color: {{ section.settings.header_color }}; padding:10px; border-radius:5px;">
    {{ section.settings.title | escape }}
  </h2>

  {%- if coll and coll.products_count > 0 -%}
    <ul class="products">
      {%- for product in coll.products -%}
        <li class="item-card">
          {%- if product.featured_image -%}
            <a href="{{ product.url }}">
              <img src="{{ product.featured_image | img_url: 'medium' }}" alt="{{ product.title | escape }}">
            </a>
          {%- endif -%}

          <h3><a href="{{ product.url }}">{{ product.title }}</a></h3>
          <p class="price">{{ product.price | money }}</p>
          <a href="{{ product.url }}" class="view-btn">View Product</a>
        </li>
      {%- endfor -%}
    </ul>
  {%- else -%}
    <p>No products in this collection yet.</p>
  {%- endif -%}
</section>

{% schema %}
{
  "name": "All products (handle)",
  "settings": [
    {
      "type": "text",
      "id": "collection_handle",
      "label": "Collection handle",
      "default": "all-products",
      "info": "Enter the exact handle (e.g., all-products)."
    },
    { "type": "text", "id": "title", "label": "Title", "default": "All products" },
    { "type": "color", "id": "header_color", "label": "Header background color", "default": "#f5f5f5" }
  ],
  "presets": [{ "name": "All products" }]
}
{% endschema %}
